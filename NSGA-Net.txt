-----------
Bài viết này giới thiệu NSGA-Net - một cách tiếp cận dùng giải thuật tiến hóa cho bài toán (NAS).

-----------
NSGA-Net được thiết kế với ba mục tiêu chính: 
(1) một thủ tục hướng đến kiểm tra đa mục tiêu và conflict, 
(2) một quy trình thăm dò hiệu quả và khai thác search space của Neural Network tiềm năng
(3) một quy trình tìm kiếm một tập hợp các kiến ​​trúc mạng đa mục tiêu đạt được trong một lần chạy.

NSGA-Net là một thuật toán khám phá một Không gian tìm kiếm của Neural Network tiềm năng
Kiến trúc trong ba bước, cụ thể là:
- bước khởi tạo quần thể create population đó là dựa trên kiến ​​thức trước từ các kiến ​​trúc thủ công, các layer, block
- một bước thăm dò exploration bao gồm sự lai ghép và đột biến của các kiến ​​trúc, và cuối cùng là một bước khai thác những khối tiềm năng
- kiến thức được lưu trữ trong toàn bộ lịch sử của các kiến ​​trúc thần kinh được đánh giá bởi mạng Bayesian Network.

NSGA-Net đạt được tỷ lệ lỗi trên bộ dữ liệu CIFAR-10 ngang bằng với các phương pháp NAS hiện đại khác trong khi sử dụng ít nguồn lực hơn.


-----------
Problem:
- Các phương pháp học tăng cường (RL) tiên tiến như và không hiệu quả trong việc sử dụng search space của họ và yêu cầu 2-3000 ngày GPU, tương ứng. 
- Phương pháp dựa trên Gradient tập trung vào mục tiêu duy nhất là giảm thiểu số liệu lỗi trên một nhiệm vụ và không thể dễ dàng thích nghi để xử lý nhiều đa mục tiêu đặc biệt là khi có xung đột. 
- Hơn nữa, hầu hết các phương pháp tiếp cận hiện đại tìm kiếm trên một khối tính toán duy nhất, tương tự như khối Inception và lặp lại nó nhiều lần nếu cần thiết để tạo thành một mạng hoàn chỉnh.

-----------
NSGA-Net:
(1) Tối ưu hóa đa mục tiêu: Triển khai trong thế giới thực của
Các mô hình NAS đòi hỏi các mạng có kích thước nhỏ và chính xác cao. Chẳng hạn, mình tìm cách tối đa hóa hiệu suất trên các thiết bị tính toán thường bị hạn chế bởi
tài nguyên phần cứng về tiêu thụ điện năng, có sẵn bộ nhớ, FLOP có sẵn và các ràng buộc độ trễ, NSGA-Net được thiết kế rõ ràng để tối ưu hóa đa mục tiêu có sự cạnh tranh.

(2) search space kiến ​​trúc linh hoạt: search space cho hầu hết các phương pháp hiện có được giới hạn trong một khối được lặp lại
nhiều lần. 
Ngược lại, tìm kiếm NSGA-Net trên toàn bộ cấu trúc của mạng. Lược đồ này khắc phục các hạn chế vốn có khi lặp lại cùng một khối tính toán trên toàn bộ mạng, cụ thể là
khối đơn có thể không tối ưu cho mọi ứng dụng và mong muốn cho phép NAS khám phá kiến ​​trúc với các khối khác nhau trong các phần khác nhau của mạng.

(3) Sắp xếp không chi phối: Thành phần cốt lõi của NSGANet là Thuật toán di truyền sắp xếp không bị ràng buộc, thuật toán tối ưu hóa đa mục tiêu
đã được sử dụng thành công để giải quyết một loạt các vấn đề đa đối tượng đã được công bố ở 1 số paper trc đây năm 2006 và 1999. Ở đây, chúng tôi tận dụng khả năng của nó để
duy trì đa dạng giữa nhiều mục tiêu xung đột, từ đó mang lại hiệu quả cao hơn và thăm dò hiệu quả của search space.

(4) Tái hợp hiệu quả: Trái ngược với các phương pháp NAS tiến hóa tiên tiến trong đó chỉ sử dụng đột biến, chúng tôi sử dụng lai ghép chéo crossover (ngoài đột biến) để kết hợp
mạng với chất lượng mong muốn trên nhiều mục tiêu

(5) Bayesian Learning: Xây dựng và sử dụng Bayesian Network lấy cảm hứng từ thuật toán tối ưu hóa Bayes (BOA) để sử dụng đầy đủ các giải pháp tiềm năng
trong lịch sử tìm kiếm và các mối tương quan vốn có giữa các lớp của kiến ​​trúc mạng


-----------
NSGA-Net. Mạng được biểu diễn dưới dạng chuỗi bit, được đào tạo thông qua độ dốc, xếp hạng và lựa chọn bởi NSGA-II, khai thác lịch sử tìm kiếm thông qua BOA. Đầu ra là một tập hợp các mạng trải rộng trên một loạt các mục tiêu phức tạp và lỗi.

-----------
1.1 ENCODEING:
Ta có thể xem kiến ​​trúc DNN như một kiểu hình và đại diện nó được ánh xạ từ như kiểu gen của nó. 
Hầu hết các kiến ​​trúc CNN hiện tại có thể được xem như là một thành phần của các computational blocks - khối tính toán - để xác định layer (ví dụ:
Khối ResNet, khối DenseNet và khối Inception,v.v.) 
và sơ đồ chỉ định thay đổi search space. Trong NSGA-Net, mỗi khối tính toán, được gọi là một pha, đặt tên là x0:

Mã hóa hoạt động xo: Không giống như hầu hết các mạng đc thiết kế thủ công và NAS, mình không lặp lại cùng một computational blocks (khối tính toán) để xây dựng một mạng. Thay vào đó, các hoạt động của
một mạng được mã hóa bởi np số pha (computational blocks)

Mỗi x(i)0 mã hóa một đồ thị có hướng bao gồm n node mô tả hoạt động trong một pha sử dụng chuỗi nhị phân. Ở đây, một node là một tính toán cơ bản
đơn vị, có thể là một phép tính đơn lẻ như convolution, pooling, batch-normalization or a sequence. Mã hóa này là 1 đại diện nhỏ gọn của kiến ​​trúc mạng
trong search space kiểu gen, nhưng đủ linh hoạt để nhiều khối tính toán trong các mạng được làm thủ công có thể được mã hóa, ví dụ: VGG, ResNet và DenseNet đều có thể mã hoá 

-----------
Hình 2 và Hình 3 cho thấy ví dụ về Crossover của cấu trúc giống VGG và cấu trúc giống DenseNet có thể dẫn đến một 
Mạng giống như ResNet. Trong hình, màu đỏ và màu xanh biểu thị các kết nối duy nhất tương ứng với VGG và DenseNet và màu đen
cho thấy các kết nối phổ biến cho cả cha mẹ. Tất cả các bit đen được giữ lại trong mã hóa con cuối cùng và chỉ các bit đó
không phổ biến giữa các cha mẹ có khả năng có thể được chọn ngẫu nhiên từ một trong các cha mẹ.

-----------
1.2 Search Space:
Để dễ dàng tính toán và hạn chế tìm kiếm search space ta gán mỗi nút trong một pha đạ diện cho chuỗi hoạt động, ví dụ như 1 node đại diện cho 3×3 convolution, sau đó là batch-normalization và ReLU.

Điều đáng chú ý là, do các nút trong mỗi giai đoạn có hoạt động giống hệt nhau, mã hóa giữa kiểu gen và kiểu hình là ánh xạ nhiều-một. Đưa ra tính toán
chi phí cần thiết để train mô hình trước khi có thể đánh giá performtion là cực kì cần thiết là tránh đánh giá bộ gen
giải mã cho cùng một kiến ​​trúc. Từ đó có thể nhanh chóng và xác định các bộ gen trùng lặp này 

-----------
2.1 Search Procedure

Trong mỗi lần lặp lại lai ghép, đột biến, cùng số lượng con (kiến trúc mạng mới) được tạo ra
từ cha mẹ được lựa chọn từ quần thể. Mỗi thành viên quần thể (bao gồm cả cha mẹ và con cái) cạnh tranh cho cả hai sự sống còn
và sinh sản (trở thành cha mẹ) trong lần lặp tiếp theo.

- Exploration: Mục tiêu của giai đoạn này là khám phá những cách đa dạng kết nối các nút để tạo thành một (computational blocks) - 1 pha

- Crossover: Các phương pháp tìm kiếm dựa trên quần thể có thể diễn ra song song khi các thành viên có thể chia sẻ (thông qua lai ghép) 
các khối building-blocks một cách hiệu quả. Trong NAS, một pha hoặc cấu trúc con của pha có thể được xem là một building-blocks. 
Chúng tôi thiết kế một toán tử chéo đồng nhất?? (homogeneous crossover),trong đó có hai thành viên quần thể được chọn làm cha mẹ, để tạo ra
con cháu (kiến trúc mạng mới) bằng cách kế thừa và kết hợp lại các building-blocks từ cha mẹ. Ý tưởng chính của toán tử chéo này là:

1) bảo tồn các building-blocks chung được chia sẻ giữa cả hai cha mẹ bằng cách kế thừa các bit phổ biến từ cả hai chuỗi bit cha mẹ
2) duy trì, tương đối, cùng độ phức tạp giữa
cha mẹ và con cái của họ bằng cách hạn chế số bit bit 1 trong chuỗi bit con nằm giữa số bit 1
trong cả bố và mẹ. Sự giao nhau được đề xuất cho phép các kiến ​​trúc được lựa chọn
(cha mẹ) để trao đổi hiệu quả các giai đoạn hoặc cấu trúc phụ trong một giai đoạn.

- Đột biến: Để tăng cường sự đa dạng (có kiến ​​trúc mạng khác nhau) của quần thể và khả năng thoát khỏi  local
optima, chúng tôi sử dụng một toán tử đột biến bit, thường là
được sử dụng trong các thuật toán di truyền mã hóa nhị phân. Do tính chất mã hóa, một bit đảo ngược trong search space kiểu gen có thể có khả năng
tạo ra một kiến ​​trúc hoàn toàn khác nhau trong search space kiểu hình.
Do đó, phải hạn chế số lượng bit có thể được lật ở mức tối đa cho mỗi hoạt động đột biến. Kết quả là, chỉ có một trong những kiến trúc pha có thể bị đột biến cùng một lúc.

- Khai thác (Exploitation): khai thác và củng cố các mô hình thường được chia sẻ giữa các kiến ​​trúc thành công trong lịch sử
khám phá (trong giai đoạn trước). Bước khai thác trong NSGA-Net lấy ý tưởng từ Thuật toán tối ưu hóa Bayes - Bayesian Optimization Algorithm (BOA). 
Cụ thể ở đây là tương quan trong các khối và đường dẫn qua các pha. Khai thác sử dụng thông tin trong lịch sử
các mạng được đánh giá để đưa ra kết quả cuối cùng của quá trình tìm kiếm. 

Cụ thể: giả sử có một mạng với ba giai đoạn. Muốn biết mối quan hệ của ba giai đoạn này. 
Với mục đích này, chúng tôi xây dựng Mạng Bayes (BN)
liên quan đến các biến này, mô hình hóa xác suất của các mạng bắt đầu bằng một pha cụ thể 
bởi sử dụng lịch sử quần thể và cập nhật những ước tính này trong
quá trình khai thác Exploitation. Các giải pháp con mới được tạo ra bằng cách lấy mẫu từ BN này. Hình 4 cho thấy một hình ảnh mô tả về điều này

-----------

Khai thác: Lấy mẫu từ Mạng Bayes (BN) do NSGA-Net xây dựng. Biểu đồ thể hiện ước tính
của các phân phối có điều kiện 
giữa cấu trúc mạng 
giữa các giai đoạn được khám phá trong bước thăm dò và cập nhật trong bước khai thác (tức là sử dụng không gian quần thể). 
Trong quá trình khai thác, mạng được xây dựng bằng các giai đoạn lấy mẫu từ BN.

-----------
- Kết quả:
Hình 6 cho thấy hai số liệu: tỷ lệ sống sót bình thường của HV và con cái,
thông qua các thế hệ khác nhau của quần thể. 
Hàm đơn điệu tăng cho thấy rằng một kiến trúc mạng tốt hơn đã được tìm thấy qua các thế hệ. 
Hàm đơn điệu giảm trong số liệu sau cho thấy rằng, đó là ngày càng khó tạo ra con cái tốt hơn (so với bố mẹ chúng).không có gì đáng ngạc nhiên 

Chúng ta có thể sử dụng một ngưỡng về tỷ lệ sống sót của con cái làm tiêu chí chấm dứt quá trình tìm kiếm và
chuyển đổi giữa thăm dò và khai thác.

Để so sánh kiến ​​trúc mạng thu được từ NSGA-Net
đến các kiến ​​trúc thủ công và tìm kiếm khác mạng bằng cách tăng số lượng bộ lọc của
mỗi nút trong các giai đoạn và huấn luyện với toàn bộ CIFAR-10.Kết quả 3,85% classification error trên bộ thử nghiệm CIFAR-10 với
3,34 triệu tham số và 1290 MFLOPs. Bảng 1 so sánh NSGA-Net với NAS đa mục tiêu khác phương pháp. Tuy nhiên so sánh hypervolume giữa những
phương pháp NAS đa mục tiêu là không khả thi do: 
1) NAS đa mục tiêu không được báo cáo
2) các mục tiêu khác nhau đã được sử dụng để ước tính độ phức tạp của các kiến ​​trúc.

-----------
Hình 7: Kiến trúc tế bào tích chập bình thường và giảm được NSGA-Net tìm thấy áp dụng cho search space. Các
đầu vào (màu xanh lá cây). Đầu ra (màu vàng) là kết quả của một hoạt động nối